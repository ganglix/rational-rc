

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>corrosion &mdash; Tinkrete alpha documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Tinkrete
          

          
          </a>

          
            
            
              <div class="version">
                0.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tinkrete</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>corrosion</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for corrosion</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Summary</span>
<span class="sd">-------</span>


<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">helper_func</span> <span class="k">as</span> <span class="nn">hf</span>

<div class="viewcode-block" id="icorr_to_mmpy"><a class="viewcode-back" href="../corrosion.html#corrosion.icorr_to_mmpy">[docs]</a><span class="k">def</span> <span class="nf">icorr_to_mmpy</span><span class="p">(</span><span class="n">icorr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;icorr_to_mmpy converts icorr [A/m^2] to corrosion rate[mm/year] using Faraday&#39;s laws</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    icorr : float</span>
<span class="sd">        corrosion current density [A/m^2]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        corrosion rate, section loss [mm/year]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">M_Fe</span> <span class="o">=</span> <span class="mf">55.8e-3</span>  <span class="c1"># kg/mol</span>
    <span class="n">rho_Fe</span> <span class="o">=</span> <span class="mf">7.874e3</span>  <span class="c1"># kg/m^3</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mf">2.0</span>

    <span class="n">F</span> <span class="o">=</span> <span class="mf">96485.33212</span>  <span class="c1"># C mol^−1</span>
    <span class="k">return</span> <span class="n">icorr</span> <span class="o">*</span> <span class="n">M_Fe</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">rho_Fe</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">*</span> <span class="mf">1000.0</span></div>


<div class="viewcode-block" id="mmpy_to_icorr"><a class="viewcode-back" href="../corrosion.html#corrosion.mmpy_to_icorr">[docs]</a><span class="k">def</span> <span class="nf">mmpy_to_icorr</span><span class="p">(</span><span class="n">rate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;mmpy_to_icorr converts corrosion rate[mm/year] to icorr [A/m^2] using Faraday&#39;s laws</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rate : float</span>
<span class="sd">        corrosion rate, section loss [mm/year]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        corrosion current density [A/m^2]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">M_Fe</span> <span class="o">=</span> <span class="mf">55.8e-3</span>  <span class="c1"># kg/mol</span>
    <span class="n">rho_Fe</span> <span class="o">=</span> <span class="mf">7.874e3</span>  <span class="c1"># kg/m^3</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mf">96485.33212</span>  <span class="c1"># C mol^−1</span>
    <span class="k">return</span> <span class="n">rate</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">rho_Fe</span> <span class="o">/</span> <span class="p">(</span><span class="n">M_Fe</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">*</span> <span class="mf">1000.0</span><span class="p">)</span></div>


<div class="viewcode-block" id="icorr_base"><a class="viewcode-back" href="../corrosion.html#corrosion.icorr_base">[docs]</a><span class="k">def</span> <span class="nf">icorr_base</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">iL</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>  <span class="c1"># SI units # regressed model for the ref</span>
    <span class="sd">&quot;&quot;&quot; calculate averaged corrosion current density over the rebar-concrete surface from resistivity, temperature, limiting current and cover thickness</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : float, numpy array</span>
<span class="sd">        resistivity [ohm.m]</span>
<span class="sd">    T : float, numpy array</span>
<span class="sd">        temperature [K]</span>
<span class="sd">    iL : float, numpy array </span>
<span class="sd">        limiting current, oxygen diffusion [ A/m^2]</span>
<span class="sd">    d : float, numpy array</span>
<span class="sd">        concrete cover depth [m]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float array</span>
<span class="sd">        icorr : corrosion current density, treated as uniform corrosion [A/m^2]</span>
<span class="sd">    </span>
<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    reference: Pour-Ghaz, M., Isgor, O. B., &amp; Ghods, P. (2009)The effect of temperature on the corrosion of steel in concrete. Part 1: Simulated polarization resistance tests and model development. Corrosion Science, 51(2), 415–425. https://doi.org/10.1016/j.corsci.2008.10.034</span>
<span class="sd">    parameters from ref</span>
<span class="sd">    SI units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># constants</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="mf">1.181102362e-3</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="mf">1.414736274e-5</span>
    <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.00121155206</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.0847693074</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="mf">0.130025167</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.800505851</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">1.23199829e-11</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.000102886027</span>
    <span class="n">V</span> <span class="o">=</span> <span class="mf">0.475258097</span>
    <span class="n">X</span> <span class="o">=</span> <span class="mf">5.03368481e-7</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="mi">90487</span>
    <span class="n">W</span> <span class="o">=</span> <span class="mf">0.0721605536</span>

    <span class="n">icorr</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">1</span>
        <span class="o">/</span> <span class="p">(</span><span class="n">tau</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">**</span> <span class="n">gamma</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span>
            <span class="n">eta</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">d</span> <span class="o">**</span> <span class="n">kappa</span> <span class="o">*</span> <span class="n">iL</span> <span class="o">**</span> <span class="n">lam</span>
            <span class="o">+</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">**</span> <span class="p">(</span><span class="n">iL</span> <span class="o">**</span> <span class="n">W</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">theta</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">iL</span><span class="p">)</span> <span class="o">**</span> <span class="n">V</span>
            <span class="o">+</span> <span class="n">X</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">**</span> <span class="n">gamma</span>
            <span class="o">+</span> <span class="n">c</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">icorr</span></div>


<div class="viewcode-block" id="theta2rho_fun"><a class="viewcode-back" href="../corrosion.html#corrosion.theta2rho_fun">[docs]</a><span class="k">def</span> <span class="nf">theta2rho_fun</span><span class="p">(</span><span class="n">theta_water</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;volumetric water content to resistivity, index regression function used&quot;&quot;&quot;</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">theta_water</span> <span class="o">**</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">rho</span></div>


<div class="viewcode-block" id="icorr_f"><a class="viewcode-back" href="../corrosion.html#corrosion.icorr_f">[docs]</a><span class="k">def</span> <span class="nf">icorr_f</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A wrapper of the icorr_base() with modified parameters (resistivity rho -&gt; volumetric water content, theta_water)</span>
<span class="sd">    by theta2rho_fun().</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pars : instance of Param class</span>

<span class="sd">            + pars.theta_water,</span>
<span class="sd">            + pars.T,</span>
<span class="sd">            + pars.iL,</span>
<span class="sd">            + pars.d,</span>
<span class="sd">            + pars.a,</span>
<span class="sd">            + pars.b</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float, numpy array</span>
<span class="sd">        icorr : corrosion current density [A/m^2]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># previously calibrated to carbonated concrete</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">iL</span> <span class="o">=</span> <span class="n">iL_f</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">icorr</span> <span class="o">=</span> <span class="n">icorr_base</span><span class="p">(</span>
        <span class="n">theta2rho_fun</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">theta_water</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">theta2rho_coeff_a</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">theta2rho_coeff_b</span><span class="p">),</span>
        <span class="n">pars</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
        <span class="n">pars</span><span class="o">.</span><span class="n">iL</span><span class="p">,</span>
        <span class="n">pars</span><span class="o">.</span><span class="n">d</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">icorr</span></div>


<div class="viewcode-block" id="iL_f"><a class="viewcode-back" href="../corrosion.html#corrosion.iL_f">[docs]</a><span class="k">def</span> <span class="nf">iL_f</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;calculate O2 limiting current density</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pars : instance of Param object</span>
<span class="sd">        parameter object that contains the material properties</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float, numpy array</span>
<span class="sd">        O2 limiting current density [A/m^2]</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    intermidiate parameters</span>
<span class="sd">    </span>
<span class="sd">    + z : number of charge, 4 for oxygen</span>
<span class="sd">    + delta : thickness of diffusion layer [m]</span>
<span class="sd">    + pars.De_O2 : diffusivity [m^2/s]</span>
<span class="sd">    + pars.Cs_g : bulk concentration [mol/m^3]</span>
<span class="sd">    + pars.epsilon_g : gas phase fraction</span>

<span class="sd">    returns</span>
<span class="sd">    -------</span>
<span class="sd">    float, numpy array</span>
<span class="sd">        iL : current density over the steel concrete interface [A/m^2]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mf">96485.3329</span>  <span class="c1"># s*A/mol</span>
    <span class="n">z</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="c1"># effective diffusivity averaged for the whole concrete medium</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">De_O2</span> <span class="o">=</span> <span class="n">De_O2_f</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">d</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">Cs_g</span> <span class="o">=</span> <span class="n">Cs_g_f</span><span class="p">()</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">epsilon_g</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">pars</span><span class="o">.</span><span class="n">theta_water</span>

    <span class="c1"># assume quick dissolution between gas and liquid phase</span>
    <span class="c1"># liquid phase diffusion is neglected[TODO], very slow iL = 0 when epsilon_g = 0</span>

    <span class="c1"># pars.epsilon_g * pars.Cs is the concentration of concrte</span>
    <span class="n">iL</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">epsilon_g</span> <span class="o">*</span> <span class="n">pars</span><span class="o">.</span><span class="n">De_O2</span> <span class="o">*</span> <span class="n">pars</span><span class="o">.</span><span class="n">Cs_g</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">iL</span></div>


<div class="viewcode-block" id="Cs_g_f"><a class="viewcode-back" href="../corrosion.html#corrosion.Cs_g_f">[docs]</a><span class="k">def</span> <span class="nf">Cs_g_f</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;atmospheric O2 concentration in gas phase on the boundary [mol/m^3], converted from 20.95% by volume&quot;&quot;&quot;</span>
    <span class="n">O2_fraction</span> <span class="o">=</span> <span class="mf">20.95</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">air_molar_vol</span> <span class="o">=</span> <span class="mf">22.4</span>  <span class="c1"># [L/mol]</span>
    <span class="n">Cs_g</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">air_molar_vol</span> <span class="o">*</span> <span class="n">O2_fraction</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># mol/m^3</span>
    <span class="k">return</span> <span class="n">Cs_g</span></div>


<div class="viewcode-block" id="De_O2_f"><a class="viewcode-back" href="../corrosion.html#corrosion.De_O2_f">[docs]</a><span class="k">def</span> <span class="nf">De_O2_f</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;calculate the O2 effective diffusivity of concrete</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pars : instance of Param object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float, numpy array</span>
<span class="sd">        O2 effective diffusivity of concrete</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    important intermediate Parameters</span>

<span class="sd">    + epsilon_p : porosity of hardened cement paste,</span>
<span class="sd">    + RH : relative humidity [-%]</span>

<span class="sd">    Gas diffusion along the aggregate-paste interface makes up for the lack of diffusion through the aggregate particles themselves.</span>
<span class="sd">    Therefore, the value of effective diffusivity is considered herein as a function of the porosity of hardened cement paste. </span>
<span class="sd">    [TODO: add temperature dependence]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">epsilon_p</span> <span class="o">=</span> <span class="n">epsilon_p_f</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">epsilon_p</span> <span class="o">=</span> <span class="n">epsilon_p</span>

    <span class="c1"># calculate internal RH with retension curve/ adsoption curve</span>
    <span class="n">WaterbyMassHCP</span> <span class="o">=</span> <span class="n">theta_water_to_WaterbyMassHCP</span><span class="p">(</span>
        <span class="n">pars</span>
    <span class="p">)</span>  <span class="c1"># water content g/g hardened cement paste</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">WaterbyMassHCP</span> <span class="o">=</span> <span class="n">WaterbyMassHCP</span>

    <span class="n">RH</span> <span class="o">=</span> <span class="n">WaterbyMassHCP_to_RH</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">RH</span> <span class="o">=</span> <span class="n">RH</span>

    <span class="c1"># [TODO] D_O2_T0 * np.e**(dU_D/R*(1/T0-1/T)) Pour-Ghaz, M., Burkan Isgor, O., &amp; Ghods, P. (2009). The effect of temperature on the corrosion of steel in concrete. Part 2: Model verification and parametric study. Corrosion Science, 51(2), 426–433. https://doi.org/10.1016/j.corsci.2008.10.036</span>
    <span class="n">De_O2</span> <span class="o">=</span> <span class="mf">1.92e-6</span> <span class="o">*</span> <span class="n">epsilon_p</span> <span class="o">**</span> <span class="mf">1.8</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">RH</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.2</span>  <span class="c1"># Papadakis 1991</span>
    <span class="k">return</span> <span class="n">De_O2</span></div>


<div class="viewcode-block" id="epsilon_p_f"><a class="viewcode-back" href="../corrosion.html#corrosion.epsilon_p_f">[docs]</a><span class="k">def</span> <span class="nf">epsilon_p_f</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;calculate the porosity of the hardened cement paste from the concrete porosity</span>
<span class="sd">    </span>
<span class="sd">    Paramters</span>
<span class="sd">    ---------</span>
<span class="sd">    pars : instance of Param object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float, numpy array</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    [TODO: when the concrete porosity is not known, the calculated porosity is time dependent at young age, a function of concrete mix and t]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">epsilon</span><span class="p">),</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># concrete porosity, epsilon is given</span>
        <span class="n">a_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">a_c</span>  <span class="c1"># aggregate cement ratio</span>
        <span class="n">w_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">w_c</span>  <span class="c1"># water cement ratio</span>
        <span class="n">rho_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">rho_c</span>  <span class="c1"># density of cement</span>
        <span class="n">rho_a</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">rho_a</span>  <span class="c1"># density of aggregate</span>
        <span class="n">rho_w</span> <span class="o">=</span> <span class="mf">1000.0</span>
        <span class="n">epsilon_p</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">a_c</span> <span class="o">*</span> <span class="n">rho_c</span> <span class="o">/</span> <span class="n">rho_a</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w_c</span> <span class="o">*</span> <span class="n">rho_c</span> <span class="o">/</span> <span class="n">rho_w</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># use calculation from mix proportioning</span>

        <span class="c1"># [TODO: epsilon is time dependent, a function of concrete mix and t]</span>
        <span class="n">epsilon_p</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">epsilon_p</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cement paste porosity, epsilon_p is not configured!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">epsilon_p</span></div>


<div class="viewcode-block" id="calibrate_f"><a class="viewcode-back" href="../corrosion.html#corrosion.calibrate_f">[docs]</a><span class="k">def</span> <span class="nf">calibrate_f</span><span class="p">(</span><span class="n">raw_model</span><span class="p">,</span> <span class="n">field_data</span><span class="p">):</span>  <span class="c1"># [TODO]</span>
    <span class="sd">&quot;&quot;&quot;A placeholder function for future use. field_data: temperature, theta_water, icorr_list&quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">raw_model</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">model</span></div>


<span class="c1"># RH and water theta is related. Use theretical model adsorption isotherm or empirical Van-Genutchten model</span>
<div class="viewcode-block" id="RH_to_WaterbyMassHCP"><a class="viewcode-back" href="../corrosion.html#corrosion.RH_to_WaterbyMassHCP">[docs]</a><span class="k">def</span> <span class="nf">RH_to_WaterbyMassHCP</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;return water content(g/g hardended cement paste) from RH in pores/environment based on w_c, cement_type, Temperature by using modified BET model</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Refernce: Xi, Y., Bazant, Z. P., &amp; Jennings, H. M. (1993). Moisture Diffusion in Cementitious Materials Adsorption Isotherms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">V_m</span> <span class="o">=</span> <span class="n">V_m_f</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">w_c</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">cement_type</span><span class="p">)</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">V_m</span> <span class="o">=</span> <span class="n">V_m</span>

    <span class="n">C_mean</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">C_f</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># mean, distribution sample</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span>

    <span class="n">k</span> <span class="o">=</span> <span class="n">k_f</span><span class="p">(</span><span class="n">C_mean</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">w_c</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">cement_type</span><span class="p">)</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>

    <span class="n">RH_devided_by_100</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">RH</span> <span class="o">/</span> <span class="mi">100</span>

    <span class="n">WaterbyMassHCP</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">V_m</span>
        <span class="o">*</span> <span class="n">C</span>
        <span class="o">*</span> <span class="n">k</span>
        <span class="o">*</span> <span class="n">RH_devided_by_100</span>
        <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="n">RH_devided_by_100</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">RH_devided_by_100</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">WaterbyMassHCP</span></div>


<div class="viewcode-block" id="WaterbyMassHCP_to_RH"><a class="viewcode-back" href="../corrosion.html#corrosion.WaterbyMassHCP_to_RH">[docs]</a><span class="k">def</span> <span class="nf">WaterbyMassHCP_to_RH</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;return RH in pores/environment from water content(g/g hardened cement paste) based on w_c, cement_type, Temperature</span>
<span class="sd">    a reverse function of RH_to_WaterbyMassHCP()&quot;&quot;&quot;</span>
    <span class="n">V_m</span> <span class="o">=</span> <span class="n">V_m_f</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">w_c</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">cement_type</span><span class="p">)</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">V_m</span> <span class="o">=</span> <span class="n">V_m</span>

    <span class="n">C_mean</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">C_f</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># mean, distribution sample</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span>

    <span class="n">k</span> <span class="o">=</span> <span class="n">k_f</span><span class="p">(</span><span class="n">C_mean</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">w_c</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">cement_type</span><span class="p">)</span>
    <span class="n">pars</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>

    <span class="n">WaterbyMassHCP</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">WaterbyMassHCP</span>

    <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">f_solve_poly2</span><span class="p">(</span>
        <span class="o">-</span><span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">C</span> <span class="o">*</span> <span class="n">V_m</span> <span class="o">/</span> <span class="n">WaterbyMassHCP</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">r1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">RH_devided_by_100</span> <span class="o">=</span> <span class="n">r1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">RH_devided_by_100</span> <span class="o">=</span> <span class="n">r2</span>

    <span class="n">RH</span> <span class="o">=</span> <span class="n">RH_devided_by_100</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="n">RH</span></div>


<div class="viewcode-block" id="V_m_f"><a class="viewcode-back" href="../corrosion.html#corrosion.V_m_f">[docs]</a><span class="k">def</span> <span class="nf">V_m_f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">w_c</span><span class="p">,</span> <span class="n">cement_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculate V_m, a BET model parameter</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : curing time/concrete age [day]</span>
<span class="sd">    w_c : water-cement ratio</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy array</span>
<span class="sd">        V_m : BET model parameter</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    ASTM C150 cement type:\n</span>
<span class="sd">    Cement Type          Description\n</span>
<span class="sd">    Type I            :   Normal\n</span>
<span class="sd">    Type II           :   Moderate Sulfate Resistance\n</span>
<span class="sd">    Type II (MH)      :   Moderate Heat of Hydration (and Moderate Sulfate Resistance)\n</span>
<span class="sd">    Type III          :   High Early Strength\n</span>
<span class="sd">    Type IV           :   Low Heat Hydration\n</span>
<span class="sd">    Type V            :   High Sulfate Resistance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">if</span> <span class="n">w_c</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">:</span>
        <span class="n">w_c</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">if</span> <span class="n">w_c</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
        <span class="n">w_c</span> <span class="o">=</span> <span class="mf">0.7</span>

    <span class="n">V_ct_cement_type_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Type I&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
        <span class="s2">&quot;Type II&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Type III&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
        <span class="s2">&quot;Type IV&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># default value is 0.9, returns default when type is not found</span>
    <span class="n">V_ct</span> <span class="o">=</span> <span class="n">V_ct_cement_type_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cement_type</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>

    <span class="n">V_m_mean</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.068</span> <span class="o">-</span> <span class="mf">0.22</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.85</span> <span class="o">+</span> <span class="mf">0.45</span> <span class="o">*</span> <span class="n">w_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">V_ct</span>
    <span class="n">V_m_std</span> <span class="o">=</span> <span class="mf">0.016</span> <span class="o">*</span> <span class="n">V_m_mean</span>  <span class="c1"># COV</span>
    <span class="n">V_m</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">Normal_custom</span><span class="p">(</span><span class="n">V_m_mean</span><span class="p">,</span> <span class="n">V_m_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">V_m</span></div>


<div class="viewcode-block" id="C_f"><a class="viewcode-back" href="../corrosion.html#corrosion.C_f">[docs]</a><span class="k">def</span> <span class="nf">C_f</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;C_f returns BET model parameter C sampled from a normal distribution</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    T : float</span>
<span class="sd">        temperature [K]</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    C varies from 10 to 50. This function is not applicable for elevated temperatures</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">C_0</span> <span class="o">=</span> <span class="mi">855</span>
    <span class="n">C_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span> <span class="o">**</span> <span class="p">(</span><span class="n">C_0</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">C_std</span> <span class="o">=</span> <span class="n">C_mean</span> <span class="o">*</span> <span class="mf">0.12</span>  <span class="c1"># COV 0.12</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">Normal_custom</span><span class="p">(</span><span class="n">C_mean</span><span class="p">,</span> <span class="n">C_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">C_mean</span><span class="p">,</span> <span class="n">C</span></div>


<div class="viewcode-block" id="k_f"><a class="viewcode-back" href="../corrosion.html#corrosion.k_f">[docs]</a><span class="k">def</span> <span class="nf">k_f</span><span class="p">(</span><span class="n">C_mean</span><span class="p">,</span> <span class="n">w_c</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">cement_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; returns BET model parameter k&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">if</span> <span class="n">w_c</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">:</span>
        <span class="n">w_c</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">if</span> <span class="n">w_c</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
        <span class="n">w_c</span> <span class="o">=</span> <span class="mf">0.7</span>

    <span class="n">N_ct_cement_type_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Type I&quot;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span>
        <span class="s2">&quot;Type II&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Type III&quot;</span><span class="p">:</span> <span class="mf">1.15</span><span class="p">,</span>
        <span class="s2">&quot;Type IV&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># default value is 1.1, returns default when type is not found</span>
    <span class="n">N_ct</span> <span class="o">=</span> <span class="n">N_ct_cement_type_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cement_type</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.5</span> <span class="o">+</span> <span class="mi">15</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.33</span> <span class="o">+</span> <span class="mf">2.2</span> <span class="o">*</span> <span class="n">w_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">N_ct</span>

    <span class="n">k_mean</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">C_mean</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">C_mean</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">k_std</span> <span class="o">=</span> <span class="n">k_mean</span> <span class="o">*</span> <span class="mf">0.007</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">Normal_custom</span><span class="p">(</span><span class="n">k_mean</span><span class="p">,</span> <span class="n">k_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">k</span></div>

    <span class="c1"># convert theta_water to W or W to theta_water</span>

<div class="viewcode-block" id="WaterbyMassHCP_to_theta_water"><a class="viewcode-back" href="../corrosion.html#corrosion.WaterbyMassHCP_to_theta_water">[docs]</a><span class="k">def</span> <span class="nf">WaterbyMassHCP_to_theta_water</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;convert water content from g/g hardened cement paste(HCP) </span>
<span class="sd">    to volumetric in HCP to volumetric in concrete&quot;&quot;&quot;</span>
    <span class="n">rho_w</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">WaterbyMassHCP</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">WaterbyMassHCP</span>

    <span class="n">rho_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">rho_c</span>
    <span class="n">rho_a</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">rho_a</span>
    <span class="n">a_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">a_c</span>
    <span class="n">w_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">w_c</span>
    <span class="n">theta_water_hcp</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">WaterbyMassHCP</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho_w</span> <span class="o">/</span> <span class="n">rho_c</span><span class="p">)</span>

    <span class="n">theta_water</span> <span class="o">=</span> <span class="n">theta_water_hcp</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">a_c</span> <span class="o">*</span> <span class="n">rho_c</span> <span class="o">/</span> <span class="n">rho_a</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w_c</span> <span class="o">*</span> <span class="n">rho_c</span> <span class="o">/</span> <span class="n">rho_w</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">theta_water</span></div>


<div class="viewcode-block" id="theta_water_to_WaterbyMassHCP"><a class="viewcode-back" href="../corrosion.html#corrosion.theta_water_to_WaterbyMassHCP">[docs]</a><span class="k">def</span> <span class="nf">theta_water_to_WaterbyMassHCP</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; convert water content from volumetric by concrete to volumetric in HCP  to g/g  inHCP</span>
<span class="sd">    a reverse function of WaterbyMassHCP_to_theta_water()&quot;&quot;&quot;</span>
    <span class="n">rho_w</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">theta_water</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">theta_water</span>
    <span class="n">rho_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">rho_c</span>
    <span class="n">rho_a</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">rho_a</span>
    <span class="n">a_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">a_c</span>
    <span class="n">w_c</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">w_c</span>

    <span class="n">theta_water_hcp</span> <span class="o">=</span> <span class="n">theta_water</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">a_c</span> <span class="o">*</span> <span class="n">rho_c</span> <span class="o">/</span> <span class="n">rho_a</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w_c</span> <span class="o">*</span> <span class="n">rho_c</span> <span class="o">/</span> <span class="n">rho_w</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">WaterbyMassHCP</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">theta_water_hcp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho_c</span> <span class="o">/</span> <span class="n">rho_w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">WaterbyMassHCP</span></div>


<div class="viewcode-block" id="Corrosion_Model"><a class="viewcode-back" href="../corrosion.html#corrosion.Corrosion_Model">[docs]</a><span class="k">class</span> <span class="nc">Corrosion_Model</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pars</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize the model with Param object and built-in coefficient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pars</span><span class="o">.</span><span class="n">theta2rho_coeff_a</span> <span class="o">=</span> <span class="mf">18.71810174</span>  <span class="c1"># [TODO: uncertainty for a and b]</span>
        <span class="n">pars</span><span class="o">.</span><span class="n">theta2rho_coeff_b</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.37938931</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span>

<div class="viewcode-block" id="Corrosion_Model.run"><a class="viewcode-back" href="../corrosion.html#corrosion.Corrosion_Model.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;solve for icorr and the corresponding section loss rate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">icorr</span> <span class="o">=</span> <span class="n">icorr_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_loss_rate</span> <span class="o">=</span> <span class="n">icorr_to_mmpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icorr</span><span class="p">)</span>  <span class="c1"># [mm/year]</span></div>

<div class="viewcode-block" id="Corrosion_Model.calibrate"><a class="viewcode-back" href="../corrosion.html#corrosion.Corrosion_Model.calibrate">[docs]</a>    <span class="k">def</span> <span class="nf">calibrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_data</span><span class="p">):</span>
        <span class="c1"># update parameters a and b</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Corrosion_Model.copy"><a class="viewcode-back" href="../corrosion.html#corrosion.Corrosion_Model.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<span class="c1">###### section loss ##########</span>

<span class="c1"># output section loss distribution at time t</span>
<div class="viewcode-block" id="x_loss_t_fun"><a class="viewcode-back" href="../corrosion.html#corrosion.x_loss_t_fun">[docs]</a><span class="k">def</span> <span class="nf">x_loss_t_fun</span><span class="p">(</span><span class="n">t_end</span><span class="p">,</span> <span class="n">n_step</span><span class="p">,</span> <span class="n">x_loss_rate</span><span class="p">,</span> <span class="n">p_active_t_curve</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;x_loss_t_fun returns x_loss samples at a SINGLE given time t_tend. the samples represents distribution of all possible x_loss with </span>
<span class="sd">    different corrosion history</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t_end : int, float</span>
<span class="sd">        year in which the x_loss is reported</span>
<span class="sd">    n_step : int</span>
<span class="sd">        number of time steps</span>
<span class="sd">    r_corr_mean : float</span>
<span class="sd">        averaged corrosion rate i.e. x-loss rate</span>
<span class="sd">    p_active_t_curve : tuple</span>
<span class="sd">        (t_lis_curve, pf_lis_curve)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy array</span>
<span class="sd">        section loss at t_end year, a large sample from the distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># probability curve data</span>
    <span class="n">t_lis_curve</span><span class="p">,</span> <span class="n">pf_lis_curve</span> <span class="o">=</span> <span class="n">p_active_t_curve</span>

    <span class="c1"># time step of interest (usually finer step)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t_end</span><span class="p">,</span> <span class="n">n_step</span><span class="p">)</span>

    <span class="c1"># at this_year, (t_end), calculate the accumulated section loss for each time step</span>
    <span class="n">age_lis</span> <span class="o">=</span> <span class="n">t_end</span> <span class="o">-</span> <span class="n">t</span>
    <span class="n">age_lis</span> <span class="o">=</span> <span class="n">age_lis</span><span class="p">[</span><span class="n">age_lis</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x_loss_lis</span> <span class="o">=</span> <span class="n">age_lis</span> <span class="o">*</span> <span class="n">x_loss_rate</span>

    <span class="c1"># probability of newly active corrosion onset for each time step</span>
    <span class="n">pf_lis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">t_lis_curve</span><span class="p">,</span> <span class="n">pf_lis_curve</span><span class="p">)</span>
    <span class="n">p_corr_onset_lis</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">pf_lis</span><span class="p">,</span><span class="n">prepend</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># sample the accumulated section loss with the the corresponding probability</span>
    <span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choices</span>
    <span class="n">x_loss_at_t</span> <span class="o">=</span> <span class="n">choices</span><span class="p">(</span><span class="n">x_loss_lis</span> <span class="p">,</span> <span class="n">p_corr_onset_lis</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">N_SAMPLE</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_loss_at_t</span><span class="p">)</span></div>


<div class="viewcode-block" id="x_loss_year"><a class="viewcode-back" href="../corrosion.html#corrosion.x_loss_year">[docs]</a><span class="k">def</span> <span class="nf">x_loss_year</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">year_lis</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">amplify</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;run x_loss_t_fun() function over time&quot;&quot;&quot;</span>
    <span class="n">t_lis</span> <span class="o">=</span> <span class="n">year_lis</span>
    <span class="n">M_cal</span> <span class="o">=</span> <span class="n">model</span>

    <span class="n">M_lis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_lis</span><span class="p">:</span>
        <span class="n">M_cal</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">M_cal</span><span class="o">.</span><span class="n">postproc</span><span class="p">()</span>
        <span class="n">M_lis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_cal</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
        <span class="c1"># plot a few distribution</span>
        <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">year_lis</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">year_lis</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">M_sel</span> <span class="o">=</span> <span class="p">[</span><span class="n">M_lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indx</span><span class="p">]</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">this_M</span><span class="o">.</span><span class="n">t</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">],</span> <span class="p">[</span><span class="n">this_M</span><span class="o">.</span><span class="n">pf</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">this_M</span><span class="o">.</span><span class="n">t</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_sel</span><span class="p">],</span> <span class="p">[</span><span class="n">this_M</span><span class="o">.</span><span class="n">pf</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_sel</span><span class="p">],</span><span class="s1">&#39;k|&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability of failure $P_f$&#39;</span><span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">this_M</span><span class="o">.</span><span class="n">t</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">],</span> <span class="p">[</span><span class="n">this_M</span><span class="o">.</span><span class="n">beta_factor</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">this_M</span><span class="o">.</span><span class="n">t</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_sel</span><span class="p">],</span> <span class="p">[</span><span class="n">this_M</span><span class="o">.</span><span class="n">beta_factor</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_sel</span><span class="p">],</span> <span class="s1">&#39;k|&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Reliability factor $\beta$&#39;</span><span class="p">)</span>

        <span class="c1"># plot mean results</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_lis</span><span class="p">,</span> <span class="p">[</span><span class="n">M</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">x_loss_limit_mean</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">],</span> <span class="s1">&#39;--C0&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_lis</span><span class="p">,</span> <span class="p">[</span><span class="n">hf</span><span class="o">.</span><span class="n">Get_mean</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">x_loss_t</span><span class="p">)</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">],</span> <span class="s1">&#39;--C1&#39;</span><span class="p">)</span>
        <span class="c1"># plot distribution</span>
        
        <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_sel</span><span class="p">:</span>
            <span class="n">hf</span><span class="o">.</span><span class="n">RS_plot</span><span class="p">(</span><span class="n">this_M</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">t_offset</span><span class="o">=</span><span class="n">this_M</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">amplify</span><span class="o">=</span><span class="n">amplify</span><span class="p">)</span>

        <span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
        <span class="n">R_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R: limit&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">S_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S: section loss&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time[year]&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;section loss/limit [mm]&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">R_patch</span><span class="p">,</span> <span class="n">S_patch</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">this_M</span><span class="o">.</span><span class="n">pf</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">],</span> <span class="p">[</span><span class="n">this_M</span><span class="o">.</span><span class="n">beta_factor</span> <span class="k">for</span> <span class="n">this_M</span> <span class="ow">in</span> <span class="n">M_lis</span><span class="p">]</span></div>


<div class="viewcode-block" id="Section_loss_Model"><a class="viewcode-back" href="../corrosion.html#corrosion.Section_loss_Model">[docs]</a><span class="k">class</span> <span class="nc">Section_loss_Model</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span>  <span class="c1"># pars with user-input</span>

<div class="viewcode-block" id="Section_loss_Model.run"><a class="viewcode-back" href="../corrosion.html#corrosion.Section_loss_Model.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_end</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;run model to solve the accumulated section loss at t_end by using x_loss_t_fun()</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t_end : int, float</span>
<span class="sd">            year</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t_end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_loss_t</span> <span class="o">=</span> <span class="n">x_loss_t_fun</span><span class="p">(</span><span class="n">t_end</span><span class="p">,</span> <span class="n">hf</span><span class="o">.</span><span class="n">N_SAMPLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">x_loss_rate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">p_active_t_curve</span><span class="p">)</span></div>

<div class="viewcode-block" id="Section_loss_Model.postproc"><a class="viewcode-back" href="../corrosion.html#corrosion.Section_loss_Model.postproc">[docs]</a>    <span class="k">def</span> <span class="nf">postproc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;calculate the Pf and beta from accumulated section loss and section loss limit</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot : bool, optional</span>
<span class="sd">            if true plot the R S curve, by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sol</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">Pf_RS</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">x_loss_limit_mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">x_loss_limit_std</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_loss_t</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pf</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_factor</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_distrib</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S_kde_fit</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_loss_t</span></div>
    
<div class="viewcode-block" id="Section_loss_Model.copy"><a class="viewcode-back" href="../corrosion.html#corrosion.Section_loss_Model.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;copy return a deep copy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Section_loss_Model.section_loss_with_year"><a class="viewcode-back" href="../corrosion.html#corrosion.Section_loss_Model.section_loss_with_year">[docs]</a>    <span class="k">def</span> <span class="nf">section_loss_with_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year_lis</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">amplify</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;use x_loss_year() to report the accumulated section loss at each time step and</span>
<span class="sd">        the corresponding Pf and beta.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        year_lis : list</span>
<span class="sd">            a list of time step [year]</span>
<span class="sd">        plot : bool, optional</span>
<span class="sd">            if true plot the RS pf beta with time, by default True</span>
<span class="sd">        amplify : int, optional</span>
<span class="sd">            scale factor to adjust the height of the distribution curve, by default 1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            (pf_list, beta_list)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pf_lis</span><span class="p">,</span> <span class="n">beta_lis</span> <span class="o">=</span> <span class="n">x_loss_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year_lis</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">amplify</span><span class="o">=</span><span class="n">amplify</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pf_lis</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">beta_lis</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Gang Li.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>